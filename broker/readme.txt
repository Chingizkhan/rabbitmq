https://www.cloudamqp.com/blog/part1-rabbitmq-best-practice.html

// docker run -d --hostname rabbitmq -p 15672:15672 -p 5672:5672 --name rabbitmq-test -e RABBITMQ_DEFAULT_USER=user -e RABBITMQ_DEFAULT_PASS=password rabbitmq:3-management

Как работает очередь RabbitMQ?
RabbitMQ принимает сообщения от поставщиков, отправляет подтверждение о приёме и перенаправляет сообщение получателям.
Получатели подтверждают, что сообщение доставлено, или сигнализируют о неудачной доставке.
Во втором случае сообщение остаётся в очереди до тех пор, пока не будет доставлено

Проверить если сообщение было доставлено не не акнуто, и сервер упал, останется ли сообщение

WARNING
Вы должны использовать разные connections для consumer и producer соответсвенно
Вы должны переиспользовать connection для producer и consumer для одинковых действий

Т.е. У вас в приложении несколько получателей и отправителей и всего два соединения,
вы переиспользуете соединение для всех отправителей, также как и для получателей, для того чтобы не вызать back pressure -
где в одном соединении отправляются огромное количество запросов и ни один получатель не может их получить или обработать.